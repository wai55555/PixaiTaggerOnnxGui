# PixAI Tagger ONNX GUI
|![](https://raw.githubusercontent.com/wai55555/PixaiTaggerOnnxGui/refs/heads/main/sample/main_window_01.png)|![](https://raw.githubusercontent.com/wai55555/PixaiTaggerOnnxGui/refs/heads/main/sample/main_window_02.jpg)|
![](https://raw.githubusercontent.com/wai55555/PixaiTaggerOnnxGui/refs/heads/main/sample/gridview_01.jpg)

## 概要 (Overview)

**PixAI Tagger ONNX GUI** は、[PixAI](https://pixai.art/) が開発した画像タグ付けモデルのONNX版を利用して、ローカル環境の画像にタグを付与するためのグラフィカルユーザーインターフェース（GUI）ツールです。
ONNXのGUIに過ぎないため、他のONNXモデルも扱えます。ただ、比較する対象のwd taggerのタグ数が10862のところ、PixAI Tagger 0.9は13461と大幅に有利です。
明らかにPixAI Taggerの方が良いと感じたので、ダウンロードして使うようになっています。

画像の自動タグ付けはもちろん、タグの閲覧、個別編集、強力な一括編集機能（特定タグの追加・削除）を備えており、画像データセットの整理を効率化します。

## インストール (Installation)

releaseのzipファイルをダウンロードして解凍してお使いください。
特に前提条件はないはずです。

## 使い方 (Usage)
画像をWクリックしてホイールやドラッグすれば大体OK
3x3表示時でも画像Wクリックとホイールとドラッグは有効です

1.  **アプリケーションを起動します。**


2.  **入力フォルダを指定します。**
    -   `参照`ボタンから画像が含まれるフォルダを選択するか、フォルダをUI上に直接ドラッグ＆ドロップします。

3.  **モデルのダウンロード（初回のみ）**
    -   モデルファイルが存在しない場合、`ダウンロード開始`ボタンが表示されます。クリックすると、Hugging Faceからモデルのダウンロードが始まります。

4.  **自動タグ付けを実行します。**
    -   `TAG`ボタンをクリックすると、入力フォルダ内の全画像に対してタグ付け処理が開始されます。
    -   既存の`.txt`ファイルがある場合は、上書きするかどうかを確認するダイアログが表示されます。

5.  **タグを編集します。**
    -   **個別編集**: 左のリストから画像を選択し、右側のビューでタグを削除または追加します。
    -   **一括編集**: `一括タグ消去`または`一括タグ追加`セクションの機能を使って、全ファイルにまたがる編集を行います。
    -   **グリッド編集**: `3x3 edit`ボタンをクリックすると、グリッドビューに切り替わり、より視覚的に編集できます。

## 主な機能 (Features)

-   **高速な自動タグ付け**: ONNX Runtimeを利用して、CPUで高速に動作する画像タグ付け。
-   **モデルの自動ダウンロード**: 初回起動時に、Hugging FaceからONNXモデルとタグファイルを自動でダウンロードします。
-   **柔軟なタグ付け設定**:
    -   `general` と `character` のカテゴリごとに、タグを生成する**しきい値**をスライダーで直感的に調整可能。
    -   カテゴリごとの**最大タグ数**も同様に設定できます。
-   **高度な画像ビューア**:
    -   画像をダブルクリックすると、リサイズ・移動可能な拡大ウィンドウで表示。
    -   マウスホイールやキーボード（`↑` `↓` `←` `→` `W` `A` `S` `D` `H` `J` `K` `L`）で次々と画像を切り替え可能。
-   **個別タグ編集**:
    -   選択中の画像のタグをボタン形式で表示。
    -   ボタンクリックで不要なタグを簡単に削除。
    -   入力欄から新しいタグ（複数可）を追加。
    -   入力欄ではキーボード（CTRL＋`↑` `↓`)で次々と画像を切り替え可能。
-   **強力な一括編集機能**:
    -   フォルダ内の全タグを集計し、出現頻度順に表示。
    -   リスト上のタグボタンをクリックするだけで、**全ファイルから特定タグを一括削除**。
    -   指定したタグを**全ファイルの先頭または末尾に一括追加**。
-   **グリッド編集ビュー**:
    -   画像を3x3のグリッドで一覧表示し、複数の画像のタグを同時に確認・編集できます。
-   **直感的なUI**:
    -   フォルダや画像、txtファイルを直接ウィンドウにドラッグ＆ドロップして読み込み。
    -   日本語・英語に対応し、OSの言語設定に応じて自動で切り替わります。

## 実装予定 (To Be Released)

- GPU利用をconfig.iniで切り替えられるようにして高速化
- バッチ処理対応による高速化


## 設定 (Configuration)

アプリケーション終了時に、ウィンドウサイズやスライダーの値などの設定が `config.ini` ファイルに自動的に保存されます。次回起動時にその設定が復元されます。

## ライセンス (License)

このプロジェクトは LGPLv3、Apache License 2.0 の下で公開されています。

## 謝辞 (Acknowledgements)

-   このツールは [PixAI](https://pixai.art/) によってトレーニングされた素晴らしいタグ付けモデルを利用しています。Pixai Taggerが出されていなければこのアプリケーションは作っていませんでした。誠にありがとうございます。
-   ONNXモデルは [deepghs](https://huggingface.co/deepghs/pixai-tagger-v0.9-onnx) によって提供されています。ありがとうございます。

